<ion-card *ngIf="!data" no-padding>
    <ion-card-content>
        <ion-spinner name="dots"></ion-spinner>
    </ion-card-content>
</ion-card>
<div *ngIf="data">
    <ion-item lines="none" color="light" id="TotalComments">
        <ion-label text-wrap>
            全部回复 {{totalCommentCount}}
        </ion-label>
        <ion-select value="latest" (ionChange)="sortComment(commentSortType.value)" 
        cancel-text="取消" ok-text="确定" #commentSortType>
            <ion-select-option value="latest">按最新</ion-select-option>
            <ion-select-option value="oldest">按最早</ion-select-option>
            <ion-select-option value="mostlike">按赞</ion-select-option>
        </ion-select>
    </ion-item>
    <div *ngFor="let comment of localComments">
        <li *ngIf="data.Seed===comment.ParentId&&depth <= 1">
            <ion-item lines="none" no-padding style="padding-left:10px;">
                <ion-avatar slot="start" class="avatar-top" (click)="goUser(comment.UserName)">
                    <img src="{{reddah.appData('userphoto_'+comment.UserName)}}" class="portrait">
                </ion-avatar>
                <ion-label text-wrap>
                    <div style="display: flex;justify-content:space-between;">
                        <span class="user-name" (click)="goUser(comment.UserName)">{{reddah.getDisplayName(comment.UserName)}}</span>
                        <div style="display: flex;" (click)="likeComment(comment)">
                            <ion-icon name="thumbs-up" [color]="comment.like?'primary':'medium'" size="small"></ion-icon>
                            <span style="color: gray;margin-left:2px;vertical-align: top;" *ngIf="comment.Count>0">{{comment.Count}}</span>
                        </div>
                    </div>
                    
                    <span>{{reddah.utcToLocal(comment.CreatedOn,"YY-MM-DD HH:mm")}}</span>
                    <div (click)="addNewComment(comment.ArticleId, comment.Id)" [innerHTML]="reddah.htmlDecode(comment.Content) | safe: 'html'"></div>
                    <span (click)="viewReply(localComments, comment)" *ngIf="comment.Count&&comment.Count>0">查看{{comment.Count}}条回复>></span>
                </ion-label>
            </ion-item>
        </li>
    </div>
</div>
