<app-header title="Menu.Recommend"></app-header>
<ion-content style="z-index: 0;">
    <ion-refresher slot="fixed" (ionRefresh)="doRefresh($event)">  
        <ion-refresher-content  
        pullingIcon="tennisball-outline"  
        pullingText="{{reddah.instant('Common.MapSlogan')}}"
        refreshingSpinner="bubbles"></ion-refresher-content>  
    </ion-refresher>  
    
    <ion-spinner name="bubbles" *ngIf="firstLoad" style="margin:15px 50%;transform: translateX(-50%);"></ion-spinner>
    <ng-template ngFor let-article [ngForOf]="reddah.articles" id="homepage" style="color: #636468;font-family: 'Segoe UI', Arial, sans-serif;">
        <div class="postModuleLiner" *ngIf="article.VideoUrl.length>0">
            <div>
                <span [class.articleTextRead]="article.Read" class="articleTitle" (click)="view(article)">{{reddah.htmlDecode(article.Title)}}</span>
                <div class="postClear"></div>
                <video id="video_{{article.Id}}" [poster]="" [src]="article.VideoUrl" controls>
                    your browser does not support playing video
                </video>
                <div class="postClear"></div>
            </div>
            <app-article-action-bar [article]="article" [userName]="userName">
            </app-article-action-bar>
        </div>
        <div class="postModuleLiner" *ngIf="article.VideoUrl.length==0">
            <div *ngIf="article.ImageUrls.length>=3" (click)="view(article)">
                <span [class.articleTextRead]="article.Read" class="articleTitle">{{reddah.htmlDecode(article.Title)}}</span>
                <div class="postClear"></div>
                <ion-card-content style="padding:0;">
                    <div class="parent">
                        <div class="container" *ngFor="let articleUrl of article.ImageUrls;index as i">
                            <img [class.left-radius]="i==0" [class.right-radius]="i==2" 
                                [id]="reddah.makeItId(articleUrl+'home')"  
                                (load)="reddah.adjustImage(articleUrl, 'home')"
                                onerror="this.src='/assets/icon/noimage.jpg'"
                                [src]="reddah.level2Cache(articleUrl)" 
                                class="picture">
                        </div>
                    </div>
                </ion-card-content>
            </div>
            <app-article-action-bar [article]="article" [userName]="userName" 
            *ngIf="article.ImageUrls.length>=3"></app-article-action-bar>

            <div *ngIf="article.ImageUrls.length>0&&article.ImageUrls.length<3" (click)="view(article)">
                <div class="listImage">
                    <div class="listImageWrapper">
                        <img class="BrowsePreviewImageOne"
                        [id]="reddah.makeItId(article.ImageUrls[0]+'home')" 
                        (load)="reddah.adjustImage(article.ImageUrls[0], 'home')"
                        onerror="this.src='/assets/icon/noimage.jpg'"
                        [src]="reddah.level2Cache(article.ImageUrls[0])">
                    </div>
                </div>
                <span [class.articleTextRead]="article.Read" class="articleTitle">{{reddah.htmlDecode(article.Title)}}</span><br>
                <div [class.articleTextRead]="article.Read">{{reddah.htmlDecode(reddah.summary(article.Content, 100))}}</div>
            </div>
            <app-article-action-bar [article]="article" [userName]="userName" 
            *ngIf="article.ImageUrls.length>0&&article.ImageUrls.length<3"></app-article-action-bar>

            <div *ngIf="article.ImageUrls.length==0" (click)="view(article)">
                <span [class.articleTextRead]="article.Read" class="articleTitle">{{reddah.htmlDecode(article.Title)}}</span><br>
                <div [class.articleTextRead]="article.Read">{{reddah.htmlDecode(reddah.summary(article.Content, 100))}}</div>
            </div>
            <div class="listInfo" *ngIf="article.ImageUrls.length==0">
                <ion-chip style="--background:#eeeeee;" *ngFor="let group of article.GroupName.split(',')">
                    <ion-icon name="chatbubble-ellipses-outline" (click)="goSearch(group)" color="dark" size="small"></ion-icon>
                    <ion-label color="dark" (click)="goSearch(group)">
                        {{group.trim()}}
                    </ion-label>
                    <ion-icon style="transform:scale(0.7);" name="caret-forward-outline" (click)="goSearch(group)" color="medium" size="small"></ion-icon>
                </ion-chip>
            </div>
            <app-article-action-bar [article]="article" [userName]="userName" 
            *ngIf="article.ImageUrls.length==0"></app-article-action-bar>
        </div>
    </ng-template>
    <ion-infinite-scroll threshold="100px" (ionInfinite)="loadData($event)">
        <ion-infinite-scroll-content loadingSpinner="bubbles" loadingText="{{ reddah.instant('Button.Loading') }}">
        </ion-infinite-scroll-content>
    </ion-infinite-scroll>
</ion-content>
<ion-fab vertical="bottom" horizontal="end" slot="fixed" style="margin-bottom:15px;margin-right:15px;">
    <ion-fab-button (click)="create()">
        <ion-icon name="leaf-outline" style="transform: rotate(90deg);"></ion-icon>
    </ion-fab-button>
</ion-fab>