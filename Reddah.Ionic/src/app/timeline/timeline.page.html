
<ion-content [scrollEvents]="true" (ionScroll)="onScroll($event)" style="background-color:white;">
    <div class="headerStart" #headerStart>
        <ion-item color="transparent" lines="none">
            <ion-icon name="arrow-round-back" slot="start" (click)="goback()"></ion-icon>
            <ion-label></ion-label>
        </ion-item>
    </div>
    <div class="headerOnScroll" #headerOnScroll>
        <ion-item color="light">
            <ion-icon name="arrow-round-back" slot="start" (click)="goback()"></ion-icon>
            <ion-label>{{userName}}</ion-label>
        </ion-item>
    </div>
    <div>   
        <div class="timelineCover" #timelineCover>
            <img-loader src="assets/icon/timg.jpg"></img-loader>
        </div>
        <div class="timelineAvatar">
            <ion-label class="userNameTitle">{{userName}}</ion-label>
            <img-loader src="assets/icon/anonymous.png"></img-loader>
        </div>
        <div *ngFor="let article of articles;index as i">
            <p *ngIf="i==0||(i>0&&articles[i-1].CreatedOn.substring(0,4)!=article.CreatedOn.substring(0,4))" class="yearTitle">
                {{article.CreatedOn.substring(0,4)}}年
            </p>
            <div class="article">
                <div class="articleDate">
                    <span *ngIf="i==0||(i>0&&articles[i-1].CreatedOn.split('T')[0]!=article.CreatedOn.split('T')[0])" class="dayTitle">{{article.CreatedOn|date:'dd'}}</span>
                    <span *ngIf="i==0||(i>0&&articles[i-1].CreatedOn.split('T')[0]!=article.CreatedOn.split('T')[0])" class="monthTitle">
                        {{article.CreatedOn | date:'MM'}}月
                    </span>
                </div>
                <div class="articleContent">
                    <ion-item no-padding lines="none" *ngIf="article.Content.length>0">
                        <ion-thumbnail slot="start">
                            <img src="{{article.Content.split('$$$')[0]}}">
                        </ion-thumbnail>
                        <ion-label class="articleContentText" text-wrap>
                            <div [innerHTML]="summary(article.Title,20)" class="articleContentTextSummary"></div>
                            <div class="articleContentTextCount" *ngIf="article.Content.split('$$$').length>0">共{{article.Content.split('$$$').length}}张</div>
                        </ion-label>
                    </ion-item>
                    <ion-item no-padding lines="none" *ngIf="article.Content.length===0">
                        <div [innerHTML]="summary(article.Title,20)" class="textOnlyArticle"></div>
                    </ion-item>
                </div>
            </div>
        </div>
        
        <ion-infinite-scroll threshold="100px" (ionInfinite)="loadData($event)">
            <ion-infinite-scroll-content
                loadingSpinner="bubbles"
                loadingText="Loading more data...">
            </ion-infinite-scroll-content>
        </ion-infinite-scroll>
    </div>
</ion-content>